<!-- ==================== NAVIGATION BAR ==================== -->
<style>
/* Navbar Specific Styles */
:root {
  --primary-blue: #1e88ff;
  --primary-orange: #ff7b00;
  --text-dark: #1e1e1e;
  --border-light: #e5e5e5;
}

.navbar {
  background-color: #fff !important;
  border-bottom: 1px solid var(--border-light);
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  min-height: 72px;
  padding: 0.75rem 1.5rem;
}

.logo-tile {
  width: 132px;
  height: 44px;
  border-radius: 12px;
  background: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 1px 4px rgba(0,0,0,.15);
  text-decoration: none;
}

.logo-tile img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.location-label {
  color: var(--primary-orange);
  font-weight: 600;
  font-size: 11px;
  line-height: 1;
  margin-bottom: 2px;
}

.location-dropdown {
  background: none;
  border: none;
  color: var(--text-dark);
  font-weight: 600;
  font-size: 15px;
  padding: 0;
  display: inline-flex;
  align-items: center;
}

.location-dropdown:hover {
  color: var(--primary-blue);
}

.center-nav .nav-link {
  color: var(--text-dark) !important;
  font-weight: 500;
  font-size: 15px;
  padding: 0.5rem 1rem;
  transition: all 0.3s ease;
}

.center-nav .nav-link.active {
  color: var(--primary-blue) !important;
  font-weight: 600;
}

.center-nav .nav-link:hover {
  color: var(--primary-blue) !important;
}

.btn-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: transparent;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-dark);
  transition: background 0.3s ease;
}

.btn-icon:hover {
  background-color: #f1f1f1;
}

.btn-icon img {
  width: 20px;
  height: 20px;
}

.profile-btn {
  border-radius: 999px;
  padding: 8px 16px;
  background: var(--primary-blue);
  color: #fff !important;
  text-decoration: none;
  font-weight: 600;
  font-size: 15px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: background 0.3s ease;
  border: none;
}

.profile-btn:hover,
.profile-btn:focus {
  background: #1a73d9;
  color: #fff;
}

.profile-btn img {
  width: 24px;
  height: 24px;
  border-radius: 50%;
}

.dropdown-menu {
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  border: none;
  margin-top: 0.5rem;
}

.dropdown-item {
  padding: 10px 16px;
  font-weight: 500;
  transition: all 0.2s ease;
}

.dropdown-item:hover {
  background-color: #f8f9fa;
  color: var(--primary-blue);
}

.navbar-toggler {
  border: none;
  padding: 0.25rem 0.5rem;
}

.navbar-toggler:focus {
  box-shadow: none;
}

.navbar-toggler-icon {
  width: 28px;
  height: 28px;
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%2830, 30, 30, 1%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2.5' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}

.offcanvas {
  max-width: 320px;
}

.offcanvas-header {
  border-bottom: 1px solid var(--border-light);
  padding: 1.25rem 1.5rem;
}

.offcanvas-title {
  font-weight: 600;
  font-size: 18px;
  color: var(--text-dark);
}

.btn-close:focus {
  box-shadow: none;
}

.offcanvas-section {
  padding: 1rem 0;
  border-bottom: 1px solid var(--border-light);
}

.offcanvas-section:last-child {
  border-bottom: none;
}

.offcanvas-section-title {
  font-size: 12px;
  font-weight: 600;
  color: #999;
  text-transform: uppercase;
  margin-bottom: 0.75rem;
  padding: 0 1.5rem;
  letter-spacing: 0.5px;
}

.offcanvas-menu-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 1.5rem;
  color: var(--text-dark);
  text-decoration: none;
  font-weight: 500;
  font-size: 15px;
  transition: all 0.2s ease;
  border-left: 3px solid transparent;
}

.offcanvas-menu-item:hover,
.offcanvas-menu-item.active {
  background-color: #f8f9fa;
  color: var(--primary-blue);
  border-left-color: var(--primary-blue);
}

.offcanvas-menu-item i {
  width: 20px;
  font-size: 18px;
}

.offcanvas-menu-item.text-danger:hover {
  color: #dc3545 !important;
  background-color: #fff5f5;
  border-left-color: #dc3545;
}

.offcanvas-user-profile {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 1rem 1.5rem;
  background: linear-gradient(135deg, var(--primary-blue) 0%, #0d6efd 100%);
  color: white;
  margin-bottom: 0.5rem;
}

.offcanvas-user-profile img {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: 2px solid white;
}

.offcanvas-user-info h6 {
  margin: 0;
  font-weight: 600;
  font-size: 16px;
}

.offcanvas-user-info small {
  opacity: 0.9;
  font-size: 13px;
}

.lang-badge {
  background: #f8f9fa;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 13px;
  color: var(--text-dark);
  font-weight: 500;
  margin-left: auto;
}

/* Responsive */
@media (min-width: 992px) {
  .navbar-toggler {
    display: none !important;
  }
}

@media (max-width: 991.98px) {
  .center-nav,
  .desktop-controls {
    display: none !important;
  }
  
  .navbar {
    padding: 0.75rem 1rem;
  }
}

@media (max-width: 768px) {
  .navbar {
    min-height: 64px;
  }
  
  .logo-tile {
    width: 110px;
    height: 38px;
  }
  
  .location-label {
    font-size: 10px;
  }
  
  .location-dropdown {
    font-size: 14px;
  }
}

@media (max-width: 576px) {
  .navbar {
    padding: 0.5rem 0.75rem;
  }
  
  .logo-tile {
    width: 90px;
    height: 32px;
  }
  
  .location-label {
    font-size: 9px;
  }
  
  .location-dropdown {
    font-size: 13px;
  }
  
  .left-section {
    gap: 0.5rem !important;
  }
}

@media (max-width: 420px) {
  .location-label {
    display: none;
  }
  
  .logo-tile {
    width: 80px;
    height: 28px;
  }
}
</style>

<!-- Main Navbar -->
<nav class="navbar navbar-expand-lg navbar-light sticky-top">
  <div class="container-fluid">
    
    <!-- Left Section: Logo + Location -->
    <div class="d-flex align-items-center gap-3 left-section">
      <!-- Logo -->
      <a class="logo-tile" href="/">
        <img src="{{ url_for('static', filename='images/caredac-logo.png') }}" alt="CareDAC">
      </a>
      
      <!-- Location Dropdown -->
      <div class="d-flex flex-column">
        <small class="location-label">Your location</small>
        <div class="dropdown">
          <button class="dropdown-toggle location-dropdown" type="button" id="locationDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Thane, Mumbai
          </button>
          <ul class="dropdown-menu" aria-labelledby="locationDropdown">
            <li><a class="dropdown-item" href="#" data-location="Thane, Mumbai">Thane, Mumbai</a></li>
            <li><a class="dropdown-item" href="#" data-location="Mumbai Central">Mumbai Central</a></li>
            <li><a class="dropdown-item" href="#" data-location="Navi Mumbai">Navi Mumbai</a></li>
            <li><a class="dropdown-item" href="#" data-location="Bandra">Bandra</a></li>
            <li><a class="dropdown-item" href="#" data-location="Pune">Pune</a></li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Right Section: Menu Items + Toggler -->
    <div class="d-flex align-items-center ms-auto gap-3">
      
      <!-- Center Nav Links (Desktop Only) -->
      <ul class="navbar-nav center-nav d-none d-lg-flex flex-row me-3 mb-0">
        <li class="nav-item">
          <a class="nav-link {% if request.path == '/' %}active{% endif %}" aria-current="page" href="/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link {% if request.path == '/appointment' %}active{% endif %}" href="/appointment">Appointment</a>
        </li>
        <li class="nav-item">
          <a class="nav-link {% if request.path == '/payments' %}active{% endif %}" href="/payments">Payments</a>
        </li>
      </ul>

      <!-- Desktop Controls -->
      <div class="desktop-controls d-none d-lg-flex align-items-center gap-2">
        
        <!-- Language Dropdown -->
        <div class="dropdown">
          <button class="btn-icon dropdown-toggle" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false" data-bs-auto-close="true">
            <img src="{{ url_for('static', filename='images/language.png') }}" alt="Language">
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown">
            <li><a class="dropdown-item lang-option" href="#" data-lang="English">English</a></li>
            <li><a class="dropdown-item lang-option" href="#" data-lang="Malay">Malay</a></li>
            <li><a class="dropdown-item lang-option" href="#" data-lang="Thai">Thai</a></li>
            <li><a class="dropdown-item lang-option" href="#" data-lang="Indonesian">Indonesian</a></li>
          </ul>
        </div>

        <!-- Search Button -->
        <button class="btn-icon" type="button" aria-label="Search" onclick="openSearch()">
          <i class="bi bi-search"></i>
        </button>

        <!-- Profile Dropdown -->
        <div class="dropdown">
          <button class="profile-btn dropdown-toggle" type="button" id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <img src="{{ url_for('static', filename='images/profile.svg') }}" alt="User">
            John Doe
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
            <li><a class="dropdown-item" href="/profile"><i class="bi bi-person me-2"></i>Profile</a></li>
            <li><a class="dropdown-item" href="/settings"><i class="bi bi-lock me-2"></i>Change Password</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item text-danger" href="/logout"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
          </ul>
        </div>
      </div>

      <!-- Mobile Menu Toggler -->
      <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenu" aria-controls="mobileMenu" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </div>
</nav>

<!-- Bootstrap Offcanvas (Mobile Menu) -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="mobileMenu" aria-labelledby="mobileMenuLabel">
  
  <!-- Offcanvas Header -->
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="mobileMenuLabel">Menu</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  
  <!-- Offcanvas Body -->
  <div class="offcanvas-body p-0">
    
    <!-- User Profile Section -->
    <div class="offcanvas-user-profile">
      <i class="bi bi-person-circle" style="font-size: 48px;"></i>
      <div class="offcanvas-user-info">
        <h6>John Doe</h6>
        <small>john.doe@example.com</small>
      </div>
    </div>

    <!-- Navigation Section -->
    <div class="offcanvas-section">
      <div class="offcanvas-section-title">Navigation</div>
      <a href="/" class="offcanvas-menu-item {% if request.path == '/' %}active{% endif %}" data-bs-dismiss="offcanvas">
        <i class="bi bi-house-door"></i>
        <span>Home</span>
      </a>
      <a href="/appointment" class="offcanvas-menu-item {% if request.path == '/appointment' %}active{% endif %}" data-bs-dismiss="offcanvas">
        <i class="bi bi-calendar-check"></i>
        <span>Appointment</span>
      </a>
      <a href="/payments" class="offcanvas-menu-item {% if request.path == '/payments' %}active{% endif %}" data-bs-dismiss="offcanvas">
        <i class="bi bi-credit-card"></i>
        <span>Payments</span>
      </a>
    </div>

    <!-- Account Section -->
    <div class="offcanvas-section">
      <div class="offcanvas-section-title">Account</div>
      <a href="/profile" class="offcanvas-menu-item" data-bs-dismiss="offcanvas">
        <i class="bi bi-person"></i>
        <span>My Profile</span>
      </a>
      <a href="/settings" class="offcanvas-menu-item" data-bs-dismiss="offcanvas">
        <i class="bi bi-lock"></i>
        <span>Change Password</span>
      </a>
      <a href="/notifications" class="offcanvas-menu-item" data-bs-dismiss="offcanvas">
        <i class="bi bi-bell"></i>
        <span>Notifications</span>
        <span class="badge bg-danger ms-auto">3</span>
      </a>
    </div>

    <!-- Settings Section -->
    <div class="offcanvas-section">
      <div class="offcanvas-section-title">Settings</div>
      
      <!-- Language Selection -->
      <a href="#" class="offcanvas-menu-item" data-bs-toggle="modal" data-bs-target="#languageModal">
        <i class="bi bi-globe"></i>
        <span>Language</span>
        <span class="lang-badge" id="currentLangMobile">English</span>
      </a>
      
      <!-- Search -->
      <a href="#" class="offcanvas-menu-item" data-bs-dismiss="offcanvas" onclick="openSearch()">
        <i class="bi bi-search"></i>
        <span>Search</span>
      </a>
      
      <!-- Dark Mode Toggle -->
      <a href="#" class="offcanvas-menu-item" onclick="toggleDarkMode(event)">
        <i class="bi bi-moon"></i>
        <span>Dark Mode</span>
        <div class="form-check form-switch ms-auto mb-0">
          <input class="form-check-input" type="checkbox" id="darkModeSwitch">
        </div>
      </a>
    </div>

    <!-- Logout -->
    <div class="offcanvas-section">
      <a href="/logout" class="offcanvas-menu-item text-danger">
        <i class="bi bi-box-arrow-right"></i>
        <span>Logout</span>
      </a>
    </div>
  </div>
</div>

<!-- Language Selection Modal (for mobile) -->
<div class="modal fade" id="languageModal" tabindex="-1" aria-labelledby="languageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="languageModalLabel">Select Language</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-0">
        <div class="list-group list-group-flush">
          <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center lang-select-mobile active" data-lang="English">
            <span><i class="bi bi-globe me-2"></i> English</span>
            <i class="bi bi-check-circle-fill text-primary"></i>
          </a>
          <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center lang-select-mobile" data-lang="Malay">
            <span><i class="bi bi-globe me-2"></i> Malay</span>
            <i class="bi bi-check-circle-fill text-primary d-none"></i>
          </a>
          <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center lang-select-mobile" data-lang="Thai">
            <span><i class="bi bi-globe me-2"></i> Thai</span>
            <i class="bi bi-check-circle-fill text-primary d-none"></i>
          </a>
          <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center lang-select-mobile" data-lang="Indonesian">
            <span><i class="bi bi-globe me-2"></i> Indonesian</span>
            <i class="bi bi-check-circle-fill text-primary d-none"></i>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ==================== LOCATION CHANGE ====================
document.querySelectorAll('[data-location]').forEach(item => {
  item.addEventListener('click', function(e) {
    e.preventDefault();
    const location = this.getAttribute('data-location');
    document.getElementById('locationDropdown').textContent = location;
  });
});

// ==================== LANGUAGE CHANGE (Desktop) ====================
document.querySelectorAll('.lang-option').forEach(item => {
  item.addEventListener('click', function(e) {
    e.preventDefault();
    const selectedLang = this.getAttribute('data-lang');
    console.log('Desktop language changed to:', selectedLang);
    // Add your language change logic here
  });
});

// ==================== LANGUAGE CHANGE (Mobile) ====================
document.querySelectorAll('.lang-select-mobile').forEach(item => {
  item.addEventListener('click', function(e) {
    e.preventDefault();
    
    document.querySelectorAll('.lang-select-mobile').forEach(el => {
      el.classList.remove('active');
      el.querySelector('.bi-check-circle-fill').classList.add('d-none');
    });
    
    this.classList.add('active');
    this.querySelector('.bi-check-circle-fill').classList.remove('d-none');
    
    const selectedLang = this.getAttribute('data-lang');
    document.getElementById('currentLangMobile').textContent = selectedLang;
    
    console.log('Mobile language changed to:', selectedLang);
    
    setTimeout(() => {
      const modalEl = document.getElementById('languageModal');
      const modal = bootstrap.Modal.getInstance(modalEl);
      if (modal) modal.hide();
    }, 300);
  });
});

// ==================== SEARCH FUNCTION ====================
function openSearch() {
  console.log('Search opened');
  alert('Search functionality - You can add a search modal here');
}

// ==================== DARK MODE TOGGLE ====================
function toggleDarkMode(e) {
  e.preventDefault();
  const darkModeSwitch = document.getElementById('darkModeSwitch');
  darkModeSwitch.checked = !darkModeSwitch.checked;
  
  if (darkModeSwitch.checked) {
    console.log('Dark mode enabled');
  } else {
    console.log('Dark mode disabled');
  }
}

document.getElementById('darkModeSwitch')?.addEventListener('change', function(e) {
  e.stopPropagation();
  if (this.checked) {
    console.log('Dark mode enabled via switch');
  } else {
    console.log('Dark mode disabled via switch');
  }
});

// ==================== AUTO-CLOSE OFFCANVAS ON RESIZE ====================
let lastWidth = window.innerWidth;
window.addEventListener('resize', function() {
  const currentWidth = window.innerWidth;
  
  if (lastWidth < 992 && currentWidth >= 992) {
    const offcanvasElement = document.getElementById('mobileMenu');
    const offcanvasInstance = bootstrap.Offcanvas.getInstance(offcanvasElement);
    if (offcanvasInstance) {
      offcanvasInstance.hide();
    }
  }
  
  lastWidth = currentWidth;
});
</script>