{% extends "base.html" %}

{% block title %}Appointments - {{ app_name }}{% endblock %}

{% block extra_css %}
<style>
  /* ==================== MINIMAL CUSTOM STYLES ==================== */
  body {
    background-color: #f8f9fa;
  }

  .previous-badge {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .appointment-card {
    transition: all 0.2s ease;
    cursor: pointer;
  }

  .appointment-card:hover {
    box-shadow: 0 3px 10px rgba(0,0,0,0.06) !important;
    transform: translateY(-2px);
  }

  .action-btn {
    transition: all 0.2s ease;
  }

  .img img {
    border: 2px solid #ff8c00;
    border-radius: 12px;
  }

  .btn-outline-none{
    display:flex;
    flex-direction:column;
  }
 

  .action-btn:hover {
    
    /*background: #1e3a8a !important;
    color: #fff !important;
    border-color: #1e3a8a !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(30, 58, 138, 0.2);*/
  }

  /* Make card clickable but not buttons */
  .appointment-card .card-body {
    position: relative;
  }

  .appointment-card .action-buttons {
    position: relative;
    z-index: 2;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .action-buttons {
      width: 100%;
    }

    .action-btn {
      flex: 1;
      justify-content: center;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="container py-4 py-md-5" style="max-width: 70%;">

  <!-- ==================== CURRENT BOOKING SECTION ==================== -->
  <div class="mb-4">
    <h6 class="fw-semibold mb-3">Current Booking</h6>
    
    <div class="card border shadow-sm rounded-3 appointment-card" data-booking-id="1" data-booking-type="current">
      <div class="card-body p-3 p-md-4">
        <div class="row g-3 align-items-center">
          
          <!-- Caregiver Info -->
          <div class="col-12 col-md-7">
            <div class="d-flex align-items-center gap-3 img">
              <img 
                src="https://i.pravatar.cc/100?img=5" 
                alt="Paula Mora" 
                class="shadow-sm"
                style="width: 55px; height: 55px; object-fit: cover;"
              />
              <div>
                <h6 class="mb-1 fw-semibold">
                  Paula Mora
                  <!--<span class="previous-badge ms-2">Active</span>-->
                </h6>
                <small class="text-muted d-flex align-items-center gap-1">
                  <!--<i class="bi bi-calendar3"></i>-->
                  Oct 17, 2023 1:55  am
                </small>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="col-12 col-md-5">
            <div class="d-flex gap-2 justify-content-md-end flex-wrap action-buttons">
              <button class="btn btn-sm btn-outline-none action-btn d-flex align-items-center gap-2" data-action="time">
                <i class="bi bi-clock"></i> 
                <span>2 hr</span>
              </button>
              <button class="btn btn-sm btn-outline-none action-btn d-flex align-items-center gap-2" data-action="call">
                <i class="bi bi-telephone"></i> 
                <span>Call</span>
              </button>
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== PREVIOUS BOOKINGS SECTION ==================== -->
  <div>
    <h6 class="fw-semibold mb-3">Previous Bookings</h6>

    <!-- Previous Appointment Card 1 -->
    <div class="card border shadow-sm rounded-3 mb-3 appointment-card" data-booking-id="2" data-booking-type="previous">
      <div class="card-body p-3 p-md-4">
        <div class="row g-3 align-items-center">
          
          <!-- Caregiver Info -->
          <div class="col-12 col-md-7">
            <div class="d-flex align-items-center gap-3 img">
              <img 
                src="https://i.pravatar.cc/100?img=8" 
                alt="Stephanie Sharkey" 
                class="shadow-sm"
                style="width: 55px; height: 55px; object-fit: cover;"
              />
              <div>
                <h6 class="mb-1 fw-semibold">Stephanie Sharkey</h6>
                <small class="text-muted d-flex align-items-center gap-1">
                  <!--<i class="bi bi-calendar3"></i>-->
                  Oct 18, 2023 1:55  am
                </small>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="col-12 col-md-5">
            <div class="d-flex gap-2 justify-content-md-end action-buttons">
              <button class="btn btn-sm btn-outline-none action-btn d-flex align-items-center gap-2" data-action="call" style>
                <i class="bi bi-telephone"></i> 
                <span>Call</span>
              </button>
              
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Previous Appointment Card 2 -->
    <div class="card border shadow-sm rounded-3 mb-3 appointment-card" data-booking-id="3" data-booking-type="previous">
      <div class="card-body p-3 p-md-4">
        <div class="row g-3 align-items-center">
          
          <!-- Caregiver Info -->
          <div class="col-12 col-md-7">
            <div class="d-flex align-items-center gap-3 img">
              <img 
                src="https://i.pravatar.cc/100?img=10" 
                alt="Alex Buckmaster" 
                class="shadow-sm"
                style="width: 55px; height: 55px; object-fit: cover;"
              />
              <div>
                <h6 class="mb-1 fw-semibold">Alex Buckmaster</h6>
                <small class="text-muted d-flex align-items-center gap-1">
                  <!--<i class="bi bi-calendar3"></i>-->
                  Oct 19, 2023 2:00  am
                </small>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="col-12 col-md-5">
            <div class="d-flex gap-2 justify-content-md-end action-buttons">
              <button class="btn btn-sm btn-outline-none action-btn d-flex align-items-center gap-2" data-action="call">
                <i class="bi bi-telephone"></i> 
                <span>Call</span>
              </button>
              
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Previous Appointment Card 3 -->
    <div class="card border shadow-sm rounded-3 mb-3 appointment-card" data-booking-id="4" data-booking-type="previous">
      <div class="card-body p-3 p-md-4">
        <div class="row g-3 align-items-center">
          
          <!-- Caregiver Info -->
          <div class="col-12 col-md-7">
            <div class="d-flex align-items-center gap-3 img">
              <img 
                src="https://i.pravatar.cc/100?img=5" 
                alt="Paula Mora" 
                class="shadow-sm"
                style="width: 55px; height: 55px; object-fit: cover;"
              />
              <div>
                <h6 class="mb-1 fw-semibold">Paula Mora</h6>
                <small class="text-muted d-flex align-items-center gap-1">
                  <!--<i class="bi bi-calendar3"></i>-->
                  Oct 20, 2023 3:00  am
                </small>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="col-12 col-md-5">
            <div class="d-flex gap-2 justify-content-md-end action-buttons">
              <button class="btn btn-sm btn-outline-none action-btn d-flex align-items-center gap-2" data-action="call">
                <i class="bi bi-telephone"></i> 
                <span>Call</span>
              </button>
              
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Previous Appointment Card 1 -->
    <div class="card border shadow-sm rounded-3 mb-3 appointment-card" data-booking-id="2" data-booking-type="previous">
      <div class="card-body p-3 p-md-4">
        <div class="row g-3 align-items-center">
          
          <!-- Caregiver Info -->
          <div class="col-12 col-md-7">
            <div class="d-flex align-items-center gap-3 img">
              <img 
                src="https://i.pravatar.cc/100?img=8" 
                alt="Stephanie Sharkey" 
                class="shadow-sm"
                style="width: 55px; height: 55px; object-fit: cover;"
              />
              <div>
                <h6 class="mb-1 fw-semibold">Stephanie Sharkey</h6>
                <small class="text-muted d-flex align-items-center gap-1">
                  <!--<i class="bi bi-calendar3"></i>-->
                  Oct 18, 2023 1:55  am
                </small>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="col-12 col-md-5">
            <div class="d-flex gap-2 justify-content-md-end action-buttons">
              <button class="btn btn-sm btn-outline-none action-btn d-flex align-items-center gap-2" data-action="call" style>
                <i class="bi bi-telephone"></i> 
                <span>Call</span>
              </button>
              
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Previous Appointment Card 2 -->
    <div class="card border shadow-sm rounded-3 mb-3 appointment-card" data-booking-id="3" data-booking-type="previous">
      <div class="card-body p-3 p-md-4">
        <div class="row g-3 align-items-center">
          
          <!-- Caregiver Info -->
          <div class="col-12 col-md-7">
            <div class="d-flex align-items-center gap-3 img">
              <img 
                src="https://i.pravatar.cc/100?img=10" 
                alt="Alex Buckmaster" 
                class="shadow-sm"
                style="width: 55px; height: 55px; object-fit: cover;"
              />
              <div>
                <h6 class="mb-1 fw-semibold">Alex Buckmaster</h6>
                <small class="text-muted d-flex align-items-center gap-1">
                  <!--<i class="bi bi-calendar3"></i>-->
                  Oct 19, 2023 2:00  am
                </small>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="col-12 col-md-5">
            <div class="d-flex gap-2 justify-content-md-end action-buttons">
              <button class="btn btn-sm btn-outline-none action-btn d-flex align-items-center gap-2" data-action="call">
                <i class="bi bi-telephone"></i> 
                <span>Call</span>
              </button>
              
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Previous Appointment Card 3 -->
    <div class="card border shadow-sm rounded-3 mb-3 appointment-card" data-booking-id="4" data-booking-type="previous">
      <div class="card-body p-3 p-md-4">
        <div class="row g-3 align-items-center">
          
          <!-- Caregiver Info -->
          <div class="col-12 col-md-7">
            <div class="d-flex align-items-center gap-3 img">
              <img 
                src="https://i.pravatar.cc/100?img=5" 
                alt="Paula Mora" 
                class="shadow-sm"
                style="width: 55px; height: 55px; object-fit: cover;"
              />
              <div>
                <h6 class="mb-1 fw-semibold">Paula Mora</h6>
                <small class="text-muted d-flex align-items-center gap-1">
                  <!--<i class="bi bi-calendar3"></i>-->
                  Oct 20, 2023 3:00  am
                </small>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="col-12 col-md-5">
            <div class="d-flex gap-2 justify-content-md-end action-buttons">
              <button class="btn btn-sm btn-outline-none action-btn d-flex align-items-center gap-2" data-action="call">
                <i class="bi bi-telephone"></i> 
                <span>Call</span>
              </button>
              
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State (Hidden by default) -->
    <div class="text-center py-5 d-none" id="emptyState">
      <i class="bi bi-calendar-x text-muted" style="font-size: 4rem;"></i>
      <h5 class="mt-3 text-muted">No previous appointments</h5>
      <p class="text-muted">Your completed appointments will appear here</p>
      <a href="/" class="btn btn-primary rounded-pill px-4 mt-2">
        <i class="bi bi-search me-2"></i>Find Caregivers
      </a>
    </div>

  </div>

</div>
{% endblock %}

{% block extra_js %}
<script>
  // ==================== ACTION BUTTON HANDLERS ====================
  document.querySelectorAll('.action-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.stopPropagation(); // Prevent card click event
      
      const action = this.getAttribute('data-action');
      const card = this.closest('.appointment-card');
      const bookingId = card.getAttribute('data-booking-id');
      const bookingType = card.getAttribute('data-booking-type');
      
      console.log('Action:', action, 'ID:', bookingId, 'Type:', bookingType);
      
      switch(action) {
        case 'call':
          // Redirect to appropriate booking details page
          viewBookingDetails(bookingId, bookingType);
          break;
          
        case 'time':
          // Show time/duration info
          showTimeInfo();
          break;
          
        default:
          console.log('Unknown action');
      }
    });
  });

  // ==================== VIEW DETAILS HANDLER ====================
  function viewBookingDetails(bookingId, bookingType) {
    // Route to correct booking details page based on type
    if (bookingType === 'current') {
      window.location.href = `/appointment/current-booking/${bookingId}`;
    } else {
      window.location.href = `/appointment/previous-booking/${bookingId}`;
    }
  }

  // ==================== SHOW TIME INFO ====================
  function showTimeInfo() {
    alert('Booking Duration: 2 hours\nRemaining Time: 1 hour 30 minutes');
  }

  // ==================== CARD CLICK HANDLER ====================
  document.querySelectorAll('.appointment-card').forEach(card => {
    card.addEventListener('click', function(e) {
      // Don't trigger if clicking on buttons
      if (e.target.closest('.action-buttons')) {
        return;
      }
      
      const bookingId = this.getAttribute('data-booking-id');
      const bookingType = this.getAttribute('data-booking-type');
      viewBookingDetails(bookingId, bookingType);
    });
  });

  // ==================== VISUAL FEEDBACK ====================
  document.querySelectorAll('.appointment-card').forEach(card => {
    card.addEventListener('mouseenter', function() {
      this.style.cursor = 'pointer';
    });
  });
</script>
{% endblock %}